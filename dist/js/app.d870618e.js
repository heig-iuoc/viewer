(function(){"use strict";var e={307:function(e,n,o){var t=o(5130),a=o(6768);function r(e,n,o,t,r,s){const i=(0,a.g2)("Home");return(0,a.uX)(),(0,a.Wv)(i)}const s={id:"app"};function i(e,n,o,t,r,i){const c=(0,a.g2)("TitleHeader"),l=(0,a.g2)("MapMain");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(c),(0,a.bF)(l)])}var c=o.p+"img/geoportail_logo.31ea8d3b.png";const l={class:"columns is-mobile title"},u=(0,a.Fv)('<div class="column is-2 logo"><img alt="Logo HEIG-VD geoportail" src="'+c+'"></div><div class="column is-2"></div><div class="column is-4"></div><div class="column is-2">Account</div><div class="column is-2">FR | EN</div>',5),p=[u];function d(e,n,o,t,r,s){return(0,a.uX)(),(0,a.CE)("div",l,p)}o(4114);var m={name:"TitleHeader",components:{},data(){return{zonesData:[]}},created(){this.zoneDropdownAdd()},methods:{async zoneDropdownAdd(){fetch("http://127.0.0.1:8000/api/zone/?format=json").then((e=>e.json())).then((e=>{e.forEach((e=>{const n={};n.name=e.name,n.slug=e.slug,this.zonesData.push(n)}))}))}}},h=o(1241);const f=(0,h.A)(m,[["render",d]]);var g=f;const w=(0,a.Lk)("div",{id:"map-root",style:{width:"100%",height:"80%"}},null,-1);function y(e,n,o,t,r,s){const i=(0,a.g2)("ButtonZone"),c=(0,a.g2)("ZoneDropdown");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c,{"menu-title":"","dark-mode":"auto",class:"dropdown-zone",ref:"dropdownComponent"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.zonesData,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:n},[(0,a.bF)(i,{zoneName:e.name,zoneSlug:e.slug},null,8,["zoneName","zoneSlug"])])))),128))])),_:1},512),w],64)}var v=o(4232);function k(e,n,o,t,r,s){return(0,a.uX)(),(0,a.CE)("section",{class:(0,v.C4)(["dropDownMenuWrapper",{"dropDownMenuWrapper--dark":r.isDarkMode,"dropDownMenuWrapper--noTitle":!o.menuTitle}])},[(0,a.Lk)("button",{class:(0,v.C4)(["dropDownMenuButton",{"dropDownMenuButton--dark":r.isDarkMode}]),ref:"menu",onClick:n[0]||(n[0]=(...e)=>s.openClose&&s.openClose(...e))},(0,v.v_)(o.menuTitle),3),(0,a.Lk)("div",{class:(0,v.C4)(["iconWrapper",{"iconWrapper--noTitle":!o.menuTitle}])},[(0,a.Lk)("div",{class:(0,v.C4)(["bar1",{"bar1--open":r.isOpen,"bar1--dark":r.isDarkMode}])},null,2),(0,a.Lk)("div",{class:(0,v.C4)(["bar2",{"bar2--open":r.isOpen,"bar2--dark":r.isDarkMode}])},null,2),(0,a.Lk)("div",{class:(0,v.C4)(["bar3",{"bar3--open":r.isOpen,"bar3--dark":r.isDarkMode}])},null,2)],2),r.isOpen?((0,a.uX)(),(0,a.CE)("section",{key:0,class:(0,v.C4)(["dropdownMenu",{"dropdownMenu--dark":r.isDarkMode}])},[(0,a.Lk)("div",{class:(0,v.C4)(["menuArrow",{"menuArrow--dark":r.isDarkMode}])},null,2),(0,a.RG)(e.$slots,"default",{},void 0,!0)],2)):(0,a.Q3)("",!0)],2)}var A={props:["darkMode","menuTitle"],data(){return{isOpen:!1,isDarkMode:!1}},methods:{openClose(){var e=this;const n=o=>{e.catchOutsideClick(o,e.$refs.menu)&&(window.removeEventListener("click",n),e.isOpen=!1)};window.addEventListener("click",n),this.isOpen=!this.isOpen},catchOutsideClick(e,n){return n!=e.target&&(!(!this.isOpen||n==e.target)||void 0)}},watch:{darkMode(e){e||(this.isDarkMode=!1),"force"==e&&(this.isDarkMode=!0),"auto"==e&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(this.isDarkMode=!0)}}};const b=(0,h.A)(A,[["render",k],["__scopeId","data-v-fe2a6368"]]);var _=b;const E={class:"has-text-weight-normal mt-2",onClick:"this.changeZone()"};function z(e,n,o,t,r,s){return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("button",E,"Etage "+(0,v.v_)(o.zoneName),1)])}var M={name:"ButtonZone",props:{zoneName:{type:String,default:"E"},zoneSlug:{type:String,default:"e"}},mounted(){},methods:{changeZone(){console.log(this.zoneName)}}};const C=(0,h.A)(M,[["render",z]]);var S=C,D=(o(2488),o(850)),O=o(8699),j=o(6e3),G=o(9022),x=o(4453),P=o(5052),F=o(2671),L=o(856),T=o(4198),X=o(6505),Z=o(5782),H=o(8343),I=o(6121),N=o(7444),W=o(9013),$=o(269),B=o(4524),R={name:"MapContainer",components:{ZoneDropdown:_,ButtonZone:S},data(){return{highlight:null,map:null,zone_source:null,zone_layer:null,space_source:null,space_layer:null,passageway_source:null,passageway_layer:null}},mounted(){this.initMap(),this.initSources(),this.initLayers(),this.displayGeometries("a"),this.map.on("pointermove",(function(e){e.map.forEachFeatureAtPixel(e.pixel,(function(e,n){null!==n&&"space"===n.get("name")&&e instanceof L.A&&e.getGeometry()instanceof P.Ay&&void 0!=e.getStyle()&&("rgba(192, 192, 192, 1)"===e.getStyle().getFill().getColor()?e.setStyle(new X.Ay({stroke:new Z.A({color:"rgba(0, 0, 0, 1)",width:2}),fill:new H.A({color:"rgba(105, 105, 105, 1)"})})):"rgba(105, 105, 105, 1)"===e.getStyle().getFill().getColor()&&e.setStyle(new X.Ay({stroke:new Z.A({color:"rgba(0, 0, 0, 1)",width:2}),fill:new H.A({color:"rgba(192, 192, 192, 1)"})})))}))}))},created(){},methods:{initMap(){W.A.defs("EPSG:2056","+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs"),(0,$.kz)(W.A),this.map=new D.A({target:"map-root",layers:[new j.A({source:new G.A})],view:new O.Ay({projection:(0,B.Jt)("EPSG:2056"),zoom:5})})},initSources(){this.zone_source=new T.A({projection:"EPSG:4326"}),this.space_source=new T.A({projection:"EPSG:4326"}),this.passageway_source=new T.A({projection:"EPSG:4326"})},initLayers(){this.zone_layer=new x.A({name:"zone",source:this.zone_source,zIndex:1,map:this.map}),this.space_layer=new x.A({name:"space",source:this.space_source,zIndex:2,map:this.map}),this.passageway_layer=new x.A({source:this.passageway_source,map:this.map,name:"passageway",zIndex:3})},async displayGeometries(e){this.displayZone(e),this.displaySpace(e),this.displayPassageway(e)},async displayZone(e){const n=await fetch(`http://127.0.0.1:8000/api/zone/${e}/?format=json`).then((e=>e.json())).then((e=>e.geom.coordinates));n[0].forEach((e=>{const n=new L.A({geometry:new P.Ay([e])});n.setStyle(new X.Ay({fill:new H.A({color:"rgba(224, 224, 224, 1)"}),stroke:new Z.A({color:"rgba(0, 0, 0, 1)"})})),n.getGeometry().transform("EPSG:4326","EPSG:2056"),this.zone_source.addFeature(n)})),this.setExtentMap(this.zone_source)},async displaySpace(e){console.log(`http://127.0.0.1:8000/api/space/by_zone_slug/${e}/?format=json`);const n=await fetch(`http://127.0.0.1:8000/api/space/by_zone_slug/${e}/?format=json`).then((e=>e.json()));n.forEach((e=>{const n=new L.A({geometry:new P.Ay(e.geom.coordinates),label:e.name});n.setStyle(new X.Ay({text:new I.A({text:e.name,font:'bold 11px "Roboto"',fill:new H.A({color:"black"})}),stroke:new Z.A({color:"rgba(0, 0, 0, 1)",width:1}),fill:new H.A({color:"rgba(192, 192, 192, 1)"})})),n.getGeometry().transform("EPSG:4326","EPSG:2056"),this.space_source.addFeature(n)}))},async displayPassageway(e){const n=await fetch(`http://127.0.0.1:8000/api/passageway/by_zone_slug/${e}/?format=json`).then((e=>e.json()));n.forEach((e=>{const n=new L.A({geometry:new F.A(e.geom.coordinates)});n.setStyle(new X.Ay({stroke:new Z.A({color:"rgba(0, 0, 0, 1)",width:1})})),n.getGeometry().transform("EPSG:4326","EPSG:2056"),this.passageway_source.addFeature(n)}))},setExtentMap(e){const n=e.getExtent(),o=(0,N.r)(n,15);this.map.getView().fit(o,this.map.getSize())}}};const K=(0,h.A)(R,[["render",y]]);var V=K,J={name:"App",components:{TitleHeader:g,MapMain:V}};const Q=(0,h.A)(J,[["render",i]]);var q=Q,U={name:"App",components:{Home:q}};const Y=(0,h.A)(U,[["render",r]]);var ee=Y;(0,t.Ef)(ee).mount("#app")}},n={};function o(t){var a=n[t];if(void 0!==a)return a.exports;var r=n[t]={exports:{}};return e[t].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(n,t,a,r){if(!t){var s=1/0;for(u=0;u<e.length;u++){t=e[u][0],a=e[u][1],r=e[u][2];for(var i=!0,c=0;c<t.length;c++)(!1&r||s>=r)&&Object.keys(o.O).every((function(e){return o.O[e](t[c])}))?t.splice(c--,1):(i=!1,r<s&&(s=r));if(i){e.splice(u--,1);var l=a();void 0!==l&&(n=l)}}return n}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[t,a,r]}}(),function(){o.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(n,{a:n}),n}}(),function(){o.d=function(e,n){for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){o.p="/"}(),function(){var e={524:0};o.O.j=function(n){return 0===e[n]};var n=function(n,t){var a,r,s=t[0],i=t[1],c=t[2],l=0;if(s.some((function(n){return 0!==e[n]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(c)var u=c(o)}for(n&&n(t);l<s.length;l++)r=s[l],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},t=self["webpackChunkgeoportail"]=self["webpackChunkgeoportail"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=o.O(void 0,[504],(function(){return o(307)}));t=o.O(t)})();
//# sourceMappingURL=app.d870618e.js.map